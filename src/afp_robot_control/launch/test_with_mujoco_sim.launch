<launch>
    <!-- 测试模式：fixed_position, circular, xy_motion, approach_contact -->
    <arg name="test_mode" default="circular" />
    
    <!-- 固定位置测试的目标位置 -->
    <arg name="target_x" default="-0.5" />
    <arg name="target_y" default="0.0" />
    <arg name="target_z" default="0.4" />
    
    <!-- 接触测试参数 -->
    <arg name="approach_height" default="0.5" />
    <arg name="contact_threshold" default="-1.0" />
    
    <!-- 阻抗控制参数 -->
    <arg name="Kp" default="1000.0" />
    <arg name="Kd" default="50.0" />
    <arg name="Ki" default="10.0" />
    
    <!-- 控制频率 -->
    <arg name="control_freq" default="125" />
    
    <!-- 1. 启动MuJoCo仿真节点（可视化） -->
    <node pkg="afp_mjc" type="mujoco_sim.py" name="mujoco_sim" output="screen">
        <!-- 模型路径在mujoco_sim.py中硬编码 -->
    </node>
    
    <!-- 2. 启动机器人模拟节点（接收轨迹命令，发布关节状态） -->
    <!-- 注意：这个节点需要你手动启动，或者在这里配置正确的包名和节点名 -->
    <!-- <node pkg="ur5e_control" type="ur5e_controller.py" name="ur5e_robot_simulator" output="screen" /> -->
    
    <!-- 3. 启动阻抗控制节点 -->
    <node pkg="afp_robot_control" type="cartesian_impedance_controller_node.py" 
          name="cartesian_impedance_controller" output="screen">
        <param name="control_freq" value="$(arg control_freq)" />
        <rosparam param="Kp" subst_value="true">[$(arg Kp), $(arg Kp), $(arg Kp), 50.0, 50.0, 50.0]</rosparam>
        <rosparam param="Kd" subst_value="true">[$(arg Kd), $(arg Kd), $(arg Kd), 5.0, 5.0, 5.0]</rosparam>
        <rosparam param="Ki" subst_value="true">[$(arg Ki), $(arg Ki), $(arg Ki), 1.0, 1.0, 1.0]</rosparam>
    </node>
    
    <!-- 4. 启动测试节点 -->
    <!-- <node pkg="afp_robot_control" type="test_ros_impedance_control.py" 
          name="impedance_test_node" output="screen">
        <param name="test_mode" value="$(arg test_mode)" />
        <rosparam param="target_position" subst_value="true">[$(arg target_x), $(arg target_y), $(arg target_z)]</rosparam>
        <param name="approach_height" value="$(arg approach_height)" />
        <param name="contact_threshold" value="$(arg contact_threshold)" />
    </node> -->
    
    <!-- RViz可视化（可选） -->
    <!-- <node pkg="rviz" type="rviz" name="rviz" args="-d $(find afp_robot_control)/config/impedance_control.rviz" /> -->

</launch>